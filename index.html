<!DOCTYPE html>
<html lang="en" data-i18n-title="app.title">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title data-i18n-title="app.title">Digital Twin IDE</title>

    <!-- External Stylesheets -->
    <link rel="stylesheet" href="css/app.css"/>
    <link rel="stylesheet" href="css/advanced-features.css"/>

    <!-- PWA Manifest and Icons -->
    <link rel="manifest" href="manifest.json"/>
    <link rel="icon" href="assets/icons/icon-192.png"/>

    <!-- Meta tags for better SEO and PWA -->
    <meta name="description" content="Progressive Web App for designing and simulating digital twins with SVG components, real-time interactions, and collaborative editing"/>
    <meta name="theme-color" content="#2c3e50"/>
    <meta name="mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
</head>
<body>
    <!-- Header with Top Menu and Toolbar -->
    <div class="header-container">
        <!-- Top Menu -->
        <nav class="top-menu">
            <ul>
                <li><a href="#" class="menu-item" data-i18n="app.menu.file">Plik</a></li>
                <li><a href="#" class="menu-item" id="simulation-menu" data-i18n="app.menu.simulation">Symulacja</a></li>
                <li><a href="#" class="menu-item" data-i18n="app.menu.view">Widok</a></li>
                <li><a href="#" class="menu-item" data-i18n="app.menu.help">Pomoc</a></li>
            </ul>
        </nav>

        <!-- Toolbar -->
        <div class="toolbar">
            <button id="export-btn" class="btn btn-success">📤 Eksportuj (.dtwin)</button>
            <button id="import-btn" class="btn btn-primary">📥 Importuj (.dtwin)</button>
            <button id="export-png-btn" class="btn btn-warning">🖼️ PNG</button>
            <button id="export-svg-btn" class="btn btn-primary">🟩 SVG</button>
            <button id="connection-mode-btn" class="btn btn-purple">🔗 Łącz komponenty</button>
        </div>
    </div>

    <!-- Simulation Panel (initially hidden) -->
    <div class="simulation-panel" id="simulation-panel" style="display: none;">
        <div class="simulation-header">
            <h3 data-i18n="app.simulation.title">📊 Symulacja Danych</h3>
            <button id="close-sim-panel" class="btn btn-text" aria-label="Close">×</button>
        </div>
        <div class="simulation-controls">
            <button id="start-sim-btn" class="btn btn-success" data-i18n="app.buttons.start">▶️ Start</button>
            <button id="stop-sim-btn" class="btn btn-danger" data-i18n="app.buttons.stop">⏸️ Stop</button>
        </div>
        <div id="simulation-list" class="simulation-list">
            <p><i data-i18n="app.simulation.noComponents">Brak komponentów do symulacji</i></p>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="container">
        <!-- Left Sidebar: Components Library -->
        <aside class="sidebar left">
            <h3>🔧 Komponenty</h3>
            <div class="component-list" id="component-library">
                <!-- Components will be loaded dynamically -->
                <div class="loading">Ładowanie komponentów...</div>
            </div>
        </aside>

        <!-- Center: Workspace Canvas -->
        <div class="workspace" id="workspace">
            <svg id="svg-canvas" xmlns="http://www.w3.org/2000/svg">
                <!-- SVG Definitions -->
                <defs>
                    <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5"
                            markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                        <path d="M 0 0 L 10 5 L 0 10 z" fill="#2c3e50"/>
                    </marker>
                    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                        <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#ddd" stroke-width="0.5"/>
                    </pattern>
                </defs>

                <!-- Grid Background -->
                <rect width="100%" height="100%" fill="url(#grid)"/>

                <!-- Components and connections will be added dynamically here -->
            </svg>
        </div>

        <!-- Right Sidebar: Properties Panel -->
        <aside class="sidebar right">
            <h3>⚙️ Właściwości</h3>
            <div id="properties-panel">
                <p>Wybierz komponent, aby edytować właściwości.</p>
            </div>
        </aside>
    </div>

    <!-- i18n and JavaScript Modules -->
    <script src="js/i18n.js"></script>
    <script type="module" src="js/app.js"></script>
    <script src="js/menu.js"></script>


    <!-- Noscript fallback -->
    <noscript>
        <div class="noscript-fallback">
            <h2>JavaScript Required</h2>
            <p>Aplikacja Digital Twin IDE wymaga włączonej obsługi JavaScript w przeglądarce.</p>
            <p>Proszę włączyć JavaScript i odświeżyć stronę.</p>
        </div>
    </noscript>

</body>
</html>

